<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Cognito-Weave Â· Patient & Caregiver</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header class="hero">
    <h1>Cognito-Weave</h1>
    <p>Pick your role and continue.</p>
    <label class="mute">
      <input type="checkbox" id="muteToggle" />
      Mute
    </label>
  </header>

  <main class="container">

    <!-- ROLE STEP -->
    <section id="roleStep" class="card">
      <h2>Who are you?</h2>
      <div class="row">
        <button id="rolePatient" class="btn btn-primary">I am a Patient</button>
        <button id="roleCaregiver" class="btn">I am a Caregiver</button>
      </div>
    </section>

    <!-- PATIENT NAME STEP -->
    <section id="nameStep" class="card hidden">
      <h2>Patient check-in</h2>
      <label for="patientName" class="label">Name</label>
      <input id="patientName" class="text" placeholder="Type patient name..." />
      <div class="row">
        <button id="nameContinue" class="btn btn-primary">Continue</button>
        <button id="backToRole1" class="btn">Back</button>
      </div>
      <div id="nameInfo" class="hint"></div>

      <!-- patient secret code box -->
      <div id="codeBox" class="codebox hidden">
        <div><strong>Your secret code:</strong> <span id="codeValue"></span></div>
        <div class="hint">Share this with your caregiver so they can view your progress.</div>
      </div>

      <!-- lightweight patient notifications -->
      <div id="patientNotice" class="notice hidden"></div>
    </section>

    <!-- PATIENT QUESTIONS -->
    <section id="step1" class="card hidden">
      <h2><span id="q1Label">1) What happened?</span></h2>
      <textarea id="ans1" class="input" placeholder="Answer hereâ€¦"></textarea>
      <div class="row">
        <button id="mic1" class="btn">ðŸŽ¤ Speak</button>
        <button id="next1" class="btn btn-primary">Next</button>
      </div>
    </section>

    <section id="step2" class="card hidden">
      <h2><span id="q2Label">2) Where did it happen?</span></h2>
      <textarea id="ans2" class="input" placeholder="Answer hereâ€¦"></textarea>
      <div class="row">
        <button id="mic2" class="btn">ðŸŽ¤ Speak</button>
        <button id="next2" class="btn btn-primary">Next</button>
      </div>
    </section>

    <section id="step3" class="card hidden">
      <h2><span id="q3Label">3) Who was with you?</span></h2>
      <textarea id="ans3" class="input" placeholder="Answer hereâ€¦"></textarea>
      <div class="row">
        <button id="mic3" class="btn">ðŸŽ¤ Speak</button>
        <button id="finish" class="btn btn-primary">Finish</button>
      </div>
    </section>

    <!-- PATIENT SUMMARY + PROGRESS (during Test) -->
    <section id="summaryCard" class="card hidden">
      <h2>Your short memory</h2>
      <div id="summaryBox" class="summary"></div>

      <!-- Dual charts (Previous test vs Today) â€“ only during Test -->
      <div id="progressWrap" class="hidden">
        <h3 style="margin-top:14px;">Memory check results</h3>
        <div id="progressNote" class="hint"></div>

        <!-- Previous test -->
        <div class="card" style="margin:10px 0;">
          <h4 style="margin:0 0 6px 0;">Previous test</h4>
          <div class="bars">
            <div class="bar-row">
              <span>What</span>
              <div class="bar"><div id="bar1Prev" class="bar-fill" style="width:0%"></div></div>
              <span id="bar1PrevV">0%</span>
            </div>
            <div class="bar-row">
              <span>Where</span>
              <div class="bar"><div id="bar2Prev" class="bar-fill" style="width:0%"></div></div>
              <span id="bar2PrevV">0%</span>
            </div>
            <div class="bar-row">
              <span>Who</span>
              <div class="bar"><div id="bar3Prev" class="bar-fill" style="width:0%"></div></div>
              <span id="bar3PrevV">0%</span>
            </div>
            <div class="bar-row total">
              <span>Total</span>
              <div class="bar"><div id="barTPrev" class="bar-fill" style="width:0%"></div></div>
              <span id="barTPrevV">0%</span>
            </div>
          </div>
        </div>

        <!-- Today -->
        <div class="card" style="margin:10px 0;">
          <h4 style="margin:0 0 6px 0;">Today</h4>
          <div class="bars">
            <div class="bar-row">
              <span>What</span>
              <div class="bar"><div id="bar1Now" class="bar-fill" style="width:0%"></div></div>
              <span id="bar1NowV">0%</span>
            </div>
            <div class="bar-row">
              <span>Where</span>
              <div class="bar"><div id="bar2Now" class="bar-fill" style="width:0%"></div></div>
              <span id="bar2NowV">0%</span>
            </div>
            <div class="bar-row">
              <span>Who</span>
              <div class="bar"><div id="bar3Now" class="bar-fill" style="width:0%"></div></div>
              <span id="bar3NowV">0%</span>
            </div>
            <div class="bar-row total">
              <span>Total</span>
              <div class="bar"><div id="barTNow" class="bar-fill" style="width:0%"></div></div>
              <span id="barTNowV">0%</span>
            </div>
          </div>
        </div>

        <div id="deltaSummary" class="hint" style="font-weight:700;"></div>

        <details id="lastReveal" style="margin-top:10px;">
          <summary>Show last record used for comparison</summary>
          <div id="lastAnswers" class="hint" style="margin-top:6px;"></div>
        </details>
      </div>

      <!-- FIX: corrected margin value -->
      <div class="row" style="margin-top:10px;">
        <button id="restart" class="btn">Start new</button>
      </div>
    </section>

    <!-- CAREGIVER LOGIN -->
    <section id="cgLogin" class="card hidden">
      <h2>Caregiver access</h2>
      <label class="label" for="cgName">Your name</label>
      <input id="cgName" class="text" placeholder="Caregiver nameâ€¦" />
      <label class="label" for="cgPatientName">Patient name</label>
      <input id="cgPatientName" class="text" placeholder="Patient nameâ€¦" />
      <label class="label" for="cgCode">Patient secret code</label>
      <input id="cgCode" class="text" placeholder="4â€“6 digit codeâ€¦" />
      <div class="row">
        <button id="cgEnter" class="btn btn-primary">Enter</button>
        <button id="backToRole2" class="btn">Back</button>
      </div>
      <div id="cgInfo" class="hint"></div>
    </section>

    <!-- CAREGIVER PANEL -->
    <section id="cgPanel" class="card hidden">
      <h2>Caregiver dashboard</h2>
      <div id="cgPatientHeader" class="hint"></div>

      <div id="cgProgressWrap" class="card" style="margin:10px 0;">
        <h3 style="margin:0 0 6px 0;">Latest Memory Tests</h3>
        <div id="cgNote" class="hint"></div>

        <div class="bars">
          <div class="bar-row">
            <span>Prev Test Total</span>
            <div class="bar"><div id="cgPrevT" class="bar-fill" style="width:0%"></div></div>
            <span id="cgPrevTv">0%</span>
          </div>
          <div class="bar-row">
            <span>Latest Test Total</span>
            <div class="bar"><div id="cgNowT" class="bar-fill" style="width:0%"></div></div>
            <span id="cgNowTv">0%</span>
          </div>
        </div>

        <div id="cgDelta" class="hint" style="font-weight:700;margin-top:8px;"></div>
      </div>

      <div class="card" style="margin:10px 0;">
        <h3 style="margin:0 0 6px 0;">Leave a suggestion</h3>
        <textarea id="cgSuggest" class="input" placeholder="Keep it short and kindâ€¦"></textarea>
        <div class="row">
          <button id="cgSend" class="btn btn-primary">Send to patient</button>
        </div>
        <div id="cgSendInfo" class="hint"></div>
      </div>
    </section>

  </main>

  <script src="/static/story_step.js"></script>
</body>
</html>
